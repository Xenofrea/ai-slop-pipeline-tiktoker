# Быстрый старт

## Установка зависимостей

```bash
npm install
```

## Запуск приложения

### Режим разработки (рекомендуется):
```bash
# Обычный режим (платные модели, лучшее качество)
npm run dev

# Бесплатный режим (экономия средств)
npm run dev -- --free
```

### Сборка и запуск:
```bash
npm run build

# Обычный режим
npm start

# Бесплатный режим
npm start -- --free
```

### Разница между режимами

| Режим | Модели | Качество | Стоимость |
|-------|--------|----------|-----------|
| Обычный | Veo 3.1 Fast + Flux Schnell + ChatGPT | Высокое | $$$ |
| FREE | Seedance Lite + Flux LoRA + Grok 4.1 Free | Среднее | $ |

## Как использовать

1. Запустите приложение командой `npm run dev`

2. Введите описание для видео, например:
   - "история про дальнобойщиков"
   - "приключение космонавта на Марсе"
   - "день из жизни программиста"

3. Выберите длину итогового видео (6, 12, 30, 45 или 60 секунд)

4. **Выберите формат видео:**
   - 9:16 (вертикальное) - для TikTok, Instagram Reels, YouTube Shorts
   - 16:9 (горизонтальное) - для YouTube, десктопа

5. Дождитесь генерации 3 вариантов текста (или перегенерируйте новые)

6. Выберите понравившийся вариант стрелками ↑↓ и нажмите Enter

7. **Reference изображение (опционально):**
   - Пропустите или укажите путь к reference изображению
   - Это изображение будет использоваться для сохранения единого стиля

8. **Кастомизация стиля (опционально):**
   - Выберите предустановленный стиль или создайте свой
   - Доступно 20 предустановленных стилей + ваши кастомные
   - Кастомные стили сохраняются в `styles.json`

9. **Выбор голоса для озвучки:**
   - Josh (Мужской, глубокий) - для серьезных повествований
   - Rachel (Женский, спокойный) - универсальный вариант
   - Clyde (Мужской, средний) - энергичный и понятный

10. Дождитесь генерации видео (это займёт несколько минут)

11. Готовое видео будет сохранено в папке `./output/session_<timestamp>/result/final_video.mp4`

## Что происходит внутри

1. **Создание сессии** - создаётся уникальная папка для сессии
2. **Генерация текста** - Claude создаёт 3 варианта истории
3. **Генерация промптов** - текст разбивается на сегменты для видео
4. **Генерация изображений и видео** - параллельно для каждого промпта:
   - Создаётся изображение через Flux
   - Генерируется 4-секундное видео через Veo 3 (или 5-секундное через Seedance в FREE режиме)
   - **Сразу сохраняется в папку videos/**
   - **Автоматический retry** - до 3 попыток при ошибках (3s → 6s → 12s между попытками)
5. **Генерация озвучки** - текст озвучивается через ElevenLabs (параллельно с видео)
6. **Склейка** - все видео склеиваются в одно
7. **Финализация** - добавляется озвучка к финальному видео

## Структура папки сессии

После генерации в папке `output/` создаётся папка сессии:

```
output/session_2025-01-23T12-30-45/
├── images/              # Сгенерированные изображения
│   ├── image_1.png
│   ├── image_2.png
│   └── ...
├── videos/              # Скачанные видео
│   ├── video_1.mp4
│   ├── video_2.mp4
│   └── ...
├── audio/               # Озвучка
│   └── narration.mp3
├── result/              # Итоговые файлы
│   ├── merged_video.mp4
│   └── final_video.mp4  # <-- ФИНАЛЬНОЕ ВИДЕО
└── metadata.json        # Метаданные сессии
```

## Примерное время работы

### Последовательная генерация (старая версия):
- 8-10 видео × 2-5 минут = 16-50 минут только на видео
- **Итого: 25-60 минут**

### Параллельная генерация (текущая версия v1.4.2):
- Генерация текста: ~10-30 секунд
- Генерация промптов: ~5-15 секунд
- **Параллельно:**
  - Генерация и сохранение всех видео: ~2-5 минут (все сразу!)
  - Генерация озвучки: ~30-60 секунд
- Склейка и финализация: ~30-60 секунд

**Итого: 3-6 минут в зависимости от количества видео** ⚡️

> Ускорение в 5-10 раз благодаря параллельной генерации и немедленному сохранению!

## Проверьте API ключи

Убедитесь, что в файле `.env` указаны правильные ключи:

```env
FAL_API_KEY="ваш_ключ_от_fal"
OPENROUTER_API_KEY="ваш_ключ_от_openrouter"
```

## Требования

- Node.js 18+
- FFmpeg (для macOS: `brew install ffmpeg`)
- Стабильное интернет-соединение
